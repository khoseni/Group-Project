<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Client</title>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.1/dist/cdn.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;

        background-image: url('https://media.licdn.com/dms/image/D5612AQE6YqoChL8gFA/article-cover_image-shrink_720_1280/0/1678821408829?e=2147483647&v=beta&t=-d06N6GnsKosKNk4BOelqli0xx5zDcbgmvEqy9U93yY');

    }

    h1 {
        text-align: center;
        color: #333;
    }

    h2 {
        margin-top: 20px;
        color: #555;
    }

    button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #0056b3;
    }

    .form-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .form-row {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin-bottom: 15px;
    }

    .form-field {
        flex: 1 1 calc(33% - 20px);
        margin-right: 10px;
    }

    .form-field:last-child {
        margin-right: 0;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    input[type="text"],
    input[type="number"],
    select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    input[type="text"]:focus,
    input[type="number"]:focus,
    select:focus {
        border-color: #007bff;
        outline: none;
    }

    @media (max-width: 600px) {
        .form-field {
            flex: 1 1 100%;
            margin-right: 0;
        }
    }
  </style>
</head>
<body x-data="app()">
  <div>
    <h1>Customer Churn Dataset</h1>
    <button onclick="window.location.href='load-data.html'">Load Data</button>
    
    <h2>Add New Customer</h2>
    <div class="form-container">
      <div class="form-row">
        <div class="form-field">
          <label for="branch">Branch:</label>
          <select id="branch" x-model="newCustomer.branch" required>
            <option value="" disabled selected>Select Branch</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
          </select>
        </div>

        <div class="form-field">
          <label for="customer_type">Customer Type:</label>
          <select id="customer_type" x-model="newCustomer.customer_type" required>
            <option value="" disabled selected>Select Type</option>
            <option value="normal">Normal</option>
            <option value="member">Member</option>
          </select>
        </div>

        <div class="form-field">
          <label for="ratings">Ratings:</label>
          <input type="number" step="0.1" id="ratings" x-model="newCustomer.ratings" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="gender">Gender:</label>
          <input type="text" id="gender" x-model="newCustomer.gender" required>
        </div>

        <div class="form-field">
          <label for="age">Age:</label>
          <input type="number" id="age" x-model="newCustomer.age" required>
        </div>

        <div class="form-field">
          <label for="credit_score">Credit Score:</label>
          <input type="number" id="credit_score" x-model="newCustomer.credit_score" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="has_creditcard">Has Credit Card:</label>
          <select id="has_creditcard" x-model="newCustomer.has_creditcard" required>
            <option value="" disabled selected>Select Yes/No</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </div>

        <div class="form-field">
          <label for="is_active_member">Active Member:</label>
          <select id="is_active_member" x-model="newCustomer.is_active_member" required>
            <option value="" disabled selected>Select Yes/No</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </div>

        <div class="form-field">
          <label for="product_category">Product Category:</label>
          <select id="product_category" x-model="newCustomer.product_category" required>
            <option value="" disabled selected>Select Category</option>
            <option value="electronic_accessories">Electronic Accessories</option>
            <option value="health_and_beauty">Health and Beauty</option>
            <option value="sports_and_travel">Sports and Travel</option>
            <option value="home_and_lifestyle">Home and Lifestyle</option>
            <option value="food_and_beverages">Food and Beverages</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="number_of_products">Number of Products:</label>
          <input type="number" id="number_of_products" x-model="newCustomer.number_of_products" required>
        </div>

        <div class="form-field">
          <label for="tax_amount">Tax Amount:</label>
          <input type="number" step="0.01" id="tax_amount" x-model="newCustomer.tax_amount" required>
        </div>

        <div class="form-field">
          <label for="price">Price:</label>
          <input type="number" step="0.01" id="price" x-model="newCustomer.price" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="total_amount">Total Amount:</label>
          <input type="number" step="0.01" id="total_amount" x-model="newCustomer.total_amount" required>
        </div>

        <div class="form-field">
          <label for="customer_churn">Customer Churn:</label>
          <select id="customer_churn" x-model="newCustomer.customer_churn" required>
            <option value="" disabled selected>Select Yes/No</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </div>

        <div class="form-field">
          <label for="tenure">Tenure:</label>
          <input type="number" id="tenure" x-model="newCustomer.tenure" required>
        </div>
      </div>

      <button type="submit" @click="handleSubmit">Add Customer</button>
    </div>
  </div>

  <script>
    function app() {
      return {
        customers: [],
        newCustomer: {
          branch: '',
          gender: '',
          age: '',
          customer_type: '',
          credit_score: '',
          has_creditcard: '',
          is_active_member: '',
          product_category: '',
          number_of_products: '',
          tax_amount: '',
          price: '',
          total_amount: '',
          ratings: '',
          customer_churn: '',
          tenure: ''
        },

        async fetchData() {
          try {
            const response = await axios.get('http://localhost:3730/api/customers');
            this.customers = response.data;
          } catch (error) {
            console.error('Error fetching data:', error);
          }
        },

        async addCustomer() {
          // Validate required fields
          const requiredFields = Object.keys(this.newCustomer).filter(field => !this.newCustomer[field]);
          if (requiredFields.length > 0) {
            alert('Please fill in all required fields.');
            return;
          }

          const customerId = `15${Math.floor(100000 + Math.random() * 900000)}`;
          const customerWithId = { ...this.newCustomer, customer_id: customerId };

          try {
            await axios.post('http://localhost:3730/api/customers', customerWithId);
            this.fetchData();
            this.clearForm();
          } catch (error) {
            console.error('Error adding customer:', error);
          }
        },

        clearForm() {
          this.newCustomer = {
            branch: '',
            gender: '',
            age: '',
            customer_type: '',
            credit_score: '',
            has_creditcard: '',
            is_active_member: '',
            product_category: '',
            number_of_products: '',
            tax_amount: '',
            price: '',
            total_amount: '',
            ratings: '',
            customer_churn: '',
            tenure: ''
          };
        },

        async deleteCustomer(customerId) {
          try {
            await axios.delete(`http://localhost:3730/api/customers/${customerId}`);
            this.fetchData();
          } catch (error) {
            console.error('Error deleting customer:', error);
          }
        },

        handleSubmit() {
          this.addCustomer();
        }
      };
    }
  </script>

</body>
</html>

